<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Code Review &amp; Phabricator</title>

  <meta name="description" content="Code Review &amp; Phabricator"/>
  <meta name="author" content="Thibault ROHMER"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <base href="https://titi.github.io/" />

  <link rel="stylesheet" href="css/fonts.css"/>
  <link rel="stylesheet" href="css/normalize.css"/>
  <link rel="stylesheet" href="css/skeleton.css"/>
  <link rel="stylesheet" href="css/custom.css"/>
  <link rel="stylesheet" href="genericons/genericons.css"/>
  
  
  <link rel="stylesheet" href="highlight/tomorrow-night.css"/>

  <link href="index.xml" rel="alternate" type="application/rss+xml" title="Posts + Links" />
  <link href="links/index.xml" rel="alternate" type="application/rss+xml" title="Links" />
  <link href="posts/index.xml" rel="alternate" type="application/rss+xml" title="Posts" />

  
</head>
<body>

<div id="flex-container">
  <input type="checkbox" id="sidebar-menu-checkbox" />
  <label for="sidebar-menu-checkbox" id="sidebar-menu"></label>

  <div id="fake-sidebar"></div>
  <div id="container">


<div id="post-header">
  <p class="post-infos">
    <time>2015-01-19 22:13</time>
    

  </p>
  <h1>Code Review &amp; Phabricator</h1>
</div>



<div class="post">
  <h1 id="why-code-reviews">Why Code Reviews?</h1>

<p><a href="http://blog.codinghorror.com/code-reviews-just-do-it/">Code Reviews: Just Do It</a> - Coding Horror</p>

<p><a href="http://www.arguingwithalgorithms.com/posts/13-03-14-code-reviews">Coding for review</a></p>

<p><a href="http://swreflections.blogspot.fr/2014/12/if-you-could-only-do-one-thing-to-make.html">If you could only do one thing to make better software, what would it be?</a></p>

<p><a href="http://blog.beanbaginc.com/2013/05/31/building-a-culture-of-code-review/">Building a culture of code review</a></p>

<blockquote>
<p>&ldquo;it’s only through collaboration that we produce our best work&rdquo;</p>
</blockquote>

<p>Code Review for Teams Too Busy to Review Code (start ~16min):<br />
<br />
<iframe class="youtube-player" width="640" height="385" src="https://www.youtube.com/embed/1m3eRFeCInY?start=980" allowfullscreen></iframe>
</p>

<h2 id="hugomore42"></h2>

<h1 id="effective-code-review">Effective Code Review</h1>

<p><a href="http://blog.beanbaginc.com/2014/12/01/practicing-effective-self-review/">Practicing effective self-review</a></p>

<p><a href="http://blog.beanbaginc.com/2013/04/24/using-checklists-for-code-review/">Using checklists for code review</a></p>

<p><a href="http://blog.fogcreek.com/increase-defect-detection-with-our-code-review-checklist-example/">Stop More Bugs with our Code Review Checklist</a></p>

<p><a href="http://swreflections.blogspot.fr/2014/08/dont-waste-time-on-code-reviews.html">Don’t waste time on Code Reviews</a></p>

<blockquote>
<p>&ldquo;developers are often distracted by the tiny problems (style issues, typos) and ignore the larger problems (algorithmic issues, design flaws, bigger picture tasks) when reviewing.&rdquo;</p>
</blockquote>

<p><img src="http://www.commitstrip.com/wp-content/uploads/2015/02/Strip-Code-review-650-finalenglish1.jpg" alt="" /><br />
Source: <a href="http://www.commitstrip.com/en/2015/02/10/the-truth-about-code-reviews/">http://www.commitstrip.com/en/2015/02/10/the-truth-about-code-reviews/</a></p>

<hr />

<h1 id="extra">Extra</h1>

<p><a href="http://code.tutsplus.com/tutorials/using-pull-requests-as-code-reviews--cms-21959">Using Pull Requests as Code Reviews</a></p>

<p><a href="https://developer.atlassian.com/blog/2015/01/a-better-pull-request/">A better pull request</a></p>

<p><a href="http://www.arguingwithalgorithms.com/posts/14-12-02-architecture-reviews">Architecture vs. Implementation Reviews</a></p>

<p><a href="http://swreflections.blogspot.fr/2014/09/can-static-analysis-replace-code-reviews.html">Can Static Analysis replace Code Reviews?</a></p>

<br />
<iframe class="youtube-player" width="640" height="385" src="https://www.youtube.com/embed/CKjRt48rZGk" allowfullscreen></iframe>


<hr />

<h1 id="tools">Tools</h1>

<p>I was looking for a solution to manage <strong>pull requests</strong> and <strong>code reviews</strong> with <a href="http://mercurial.selenic.com/">Mercurial</a>.</p>

<h2 id="hglab">HgLab</h2>

<p><a href="https://hglabhq.com/">HgLab</a> is pretty cool. Basically, it&rsquo;s a GitHub interface for a Mercurial repository.
It is really look-alike and there are cool features: comment about a particular commit, on a specific line, stats with code languages, pushlog, markdow, wiki, users and groups rights, &hellip;</p>

<p>At the time (november 2014), there was no pull request, but it was in the <a href="https://hglabhq.com/roadmap">roadmap</a> and GUI was already showing a dedicated button.<br />
However, there was a feature called <strong>Commit Approvals</strong> + comments which allowed enough to watch commits and practice code review.</p>

<p>Unfortunately, I had performance issue with a huge repository: interface was really slow.<br />
I contacted HgLab creator and he told me he was working on it. He was fast and precise in his answers, which was appreciable.</p>

<p>In the end, it was a litlle light for what I was trying to achieve :</p>

<ul>
<li>no interface dedicated to code review</li>
<li>post-push review only (you have to share code with others first)</li>
<li>commit approval tool is convenient but too simple

<ul>
<li>no way to reject commit</li>
<li>no way to know if a commit was reviewed</li>
<li>hard to identify commits to be checked</li>
</ul></li>
<li>pull request not yet available, see roadmap</li>
</ul>

<hr />

<h2 id="review-board">Review Board</h2>

<p>A collegue of mine tried <a href="https://www.reviewboard.org/">Review Board</a> with his team. It worked but was a bit painful to set up.</p>

<p>If I remember correctly, he also said that review had to be manually &ldquo;asked for&rdquo;, rather than automatically triggered.</p>

<p>There was a Visual Studio plugin but I didn&rsquo;t play enough to make my opinion.</p>

<hr />

<h2 id="crucible">Crucible</h2>

<p>From Atlassian (awesome tutorials and tools)
<a href="https://www.atlassian.com/software/crucible/overview/screenshot-tour">Crucible overview</a></p>

<hr />

<h2 id="phabricator">Phabricator</h2>

<p>Then I discovered <a href="http://phabricator.org/">Phabricator</a>, which is coded by guys from Facebook.</p>

<h3 id="presentation">Presentation</h3>

<blockquote>
<p>&ldquo;Phabricator is a collection of open source web applications that help software companies build better software.&rdquo;</p>
</blockquote>

<ul>
<li><a href="http://phabricator.org/">Official Website</a></li>
<li><a href="http://phabricator.org/tour/">Screenshot tour</a></li>
<li><a href="https://secure.phabricator.com/">&ldquo;Demo&rdquo; website</a></li>
<li><a href="http://en.wikipedia.org/wiki/Phabricator">Wikipedia</a></li>
</ul>

<p>I&rsquo;m pretty impressed.<br />
Also it&rsquo;s free!</p>

<h3 id="details">Details</h3>

<p>Server has to be installed on a linux box. But it&rsquo;s pretty straightforward and easy installation + configuration.</p>

<p>Phabricator can work with <code>svn</code>, <code>git</code> and <code>mercurial</code> repositories.</p>

<p>It can either poll an existing repository, or manage one itself.
Either way, their is an initial phase where the repository is fully parsed to store infos in a database.
It can take a few hours for huge repositories, and it will burn your CPU and I/O but that&rsquo;s it.
You can add several repositories.</p>

<p>The GUI is excellent and is composed of a lot of tools, but in an homogenous way.
Amongst apps, the most interesting ones are:</p>

<ul>
<li>Code review (pre-push[review] and post-push[audit])</li>
<li>Herald (automatic notifications with a lot of customization)</li>
<li>Bug tracker / Tasks</li>
<li>Conpherence (somewhat like a tchat with markdown)</li>
<li>Memes support!</li>
<li>Projects / Flags / Hashtag / Owners</li>
<li>Wiki</li>
</ul>

<p>I invite everyone to <strong>read this page</strong>: <a href="https://secure.phabricator.com/book/phabricator/article/reviews_vs_audit/">User Guide: Review vs Audit </a><br />
Apart from tools, code reviews concepts are well explained.</p>

<p>In the end, it a great sum of awesome and well crafted tools.<br />
Also they have a great sens of humor: have a look at the links in the footer of their homepage! (+memes generator inside)</p>

<p>Interface is simple and really easy to discover.<br />
Tracability levels and details are amazing!<br />
Want to upload an image in a comment: just drag it from your filesystem, and voilà ! <span class="genericon genericon-heart"></span><span class="genericon genericon-heart"></span><span class="genericon genericon-heart"></span></p>

<h3 id="arcanist">Arcanist</h3>

<p>Since then, I&rsquo;ve played with Arcanist to do pre-push reviews.</p>

<p><a href="https://secure.phabricator.com/book/phabricator/article/arcanist/">Arcanist User Guide</a><br />
<a href="https://secure.phabricator.com/book/phabricator/article/arcanist_windows/">Arcanist User Guide: Windows</a></p>

<p><a href="https://secure.phabricator.com/book/phabricator/article/reviews_vs_audit/">User Guide: Review vs Audit</a><br />
<a href="http://verraes.net/2013/10/pre-merge-code-reviews/">Pre-merge Code Reviews</a><br />
<a href="https://www.youtube.com/watch?v=CKjRt48rZGk">Mondrian Code Review On The Web</a> - Youtube</p>

<p>It&rsquo;s not as practical with a Mercurial repository than with a git one, especially <code>arc land</code>, but it&rsquo;s ok.</p>

<p>Here&rsquo;s how to get started on windows:</p>

<h4 id="install-php">Install PHP</h4>

<ul>
<li>Download setup on <a href="http://php.iis.net/">http://php.iis.net/</a> and install it</li>
<li>Fix PATH environment variable after installation to add the missing &ldquo;(x86)&rdquo;:
<code>
C:\Program Files (x86)\PHP\v5.3
</code></li>
</ul>

<h4 id="install-arcanist">Install Arcanist</h4>

<p>Download the following repository, either with <code>Download ZIP</code> link (on the right) or git:</p>

<ul>
<li><a href="https://github.com/phacility/arcanist/">arcanist on GitHub</a></li>
<li><a href="https://github.com/phacility/libphutil/">libphutil sur GitHub</a></li>
</ul>

<p>Extract them in a common folder, for instance:</p>

<pre><code>E:\BuildSystem\Phabricator\
                          \arcanist
                          \libphutil
</code></pre>

<p>I recommend to rename folders &ldquo;arcanist&rdquo; and &ldquo;libphutil&rdquo; in case you&rsquo;ve used the download ZIP link because GitHub add <strong>-master</strong> in the name.</p>

<p>Then add folder E:\BuildSystem\Phabricator\<strong>arcanist\bin</strong> to the PATH environment variable.</p>

<h4 id="configure-arcanist">Configure Arcanist</h4>

<p>Once and for all, in a terminal:</p>

<ul>
<li><p>Set phabricator url:</p>

<pre><code class="language-html">arc set-config default http://phabricator-test.esker.corp
</code></pre>

<p><em>Edit: not required if you have a .arcconfig file in your project</em></p></li>

<li><p>Allow arcanist web service:</p>

<pre><code class="language-html">arc install-certificate
</code></pre>

<p>. Copy url displayed in terminal, ex: <a href="http://phabricator-test.esker.corp/conduit/token/">http://phabricator-test.esker.corp/conduit/token/</a><br />
. Login &amp; copy the displayed token from the web page into your terminal</p></li>

<li><p>Setup editor:</p>

<pre><code class="language-html">arc set-config editor &quot;\&quot;C:\Program Files (x86)\Notepad++\notepad++.exe\&quot; -multiInst -nosession&quot;
</code></pre>

<p>According to officiel documentation:  &ldquo;You can not use Notepad as your editor, because it does not have a blocking mode.&rdquo;<br />
I&rsquo;m using Notepad2 which works great. But Notepad++ and GitPad work too.</p></li>
</ul>

<h4 id="submit-code-for-pre-push-review">Submit code for pre-push review</h4>

<ul>
<li>Do one or more commits, still in <code>draft</code> state (not pushed).</li>
<li>Open a terminal and type:
<code>html
arc diff
</code>
Editor is going to open, you have to specify some infos:<br /></li>
<li>test plan ; can be optionnal, cf config differential.require-test-plan-field<br /></li>
<li>reviewers ; you can specify one or several (comma separation)</li>
</ul>

<h4 id="arc-patch">Arc patch</h4>

<p>Reviewer can inject the commits into his repository with <code>arc patch &lt;revision&gt;</code>.
It will first update the repository on the very ancestor your development started.</p>

<h4 id="finalize-push">Finalize push</h4>

<p>Once code review has been approved, you can push your commit(s).
Phabricator is going to automatically close the code review when it will see commits in repository (can also be done manually).</p>

<p>Make sure to re-do <code>arc diff</code> each time you bring modifications. For instance in case you rebase before push.
Otherwise Phabricator will ignore the new commits because changesets don&rsquo;t match.</p>

<p>See <a href="https://secure.phabricator.com/book/phabricator/article/differential_faq/">Differential User Guide: FAQ</a></p>

<p><code>arc land</code> allows to do merge + push automatically.
Unfortunately, it doesn&rsquo;t work to merge a branch on itself yet, you have to use bookmarks.
See ticket: <a href="https://secure.phabricator.com/T3855">https://secure.phabricator.com/T3855</a></p>

<h4 id="known-issues">Known issues</h4>

<p>In case you have encoding warnings, you can use <strong>&ndash;encoding</strong>. See <a href="https://secure.phabricator.com/book/phabricator/article/utf8/">https://secure.phabricator.com/book/phabricator/article/utf8/</a></p>

<p>In case you got: &ldquo;Command failed with error #1!&rdquo; with &ldquo;STDERR&rdquo; &ldquo;not found!&rdquo;, you&rsquo;re likely missing the <code>default</code> repository in mercurial. See <code>[paths]</code> section in your <code>.hg/hgrc</code>.</p>

<h4 id="go-further">Go further</h4>

<p><a href="https://secure.phabricator.com/book/phabricator/article/arcanist_new_project/">.arcconfig documentation</a></p>

<p>Sample:</p>

<pre><code>{
	&quot;phabricator.uri&quot; : &quot;http://ly-phabricator-test.esker.corp/&quot;
}
</code></pre>

<p>Linters:<br />
<a href="https://secure.phabricator.com/book/phabricator/article/arcanist_lint/">Arcanist User Guide: Lint</a><br />
<a href="https://secure.phabricator.com/book/phabricator/article/arcanist_extending_lint/">Arcanist User Guide: Customizing Existing Linters</a></p>

<pre><code>{
	&quot;linters&quot;:
	{
		&quot;jshint no_SAP&quot;:
		{
			&quot;type&quot;: &quot;jshint&quot;,
			&quot;bin&quot;: &quot;C:\\Users\\TiTi\\AppData\\Roaming\\npm\\jshint.cmd&quot;,
			&quot;include&quot;: &quot;(^DocMgr2/WebAccess/no_SAP/ap_reject.js$)&quot;,
			&quot;severity.rules&quot;:
			{
				&quot;(^W)&quot;: &quot;error&quot;
			}
		}
	}
}
</code></pre>
</div>


  <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'thibaultrohmer';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



<footer>
  <p class="footnote">Copyright &copy; 2017: All rights reserved by <a href="mailto:thibault.rohmer@gmail.com">Thibault ROHMER</a></p>
</footer>

  </div>
  <div id="container-mask"></div>
<div id="sidebar">
<div class="sidebar">
  <div class="sidebar-about">
    <a href="https://titi.github.io">
      <img src="media/me.jpg" title="Thibault ROHMER" alt="Me" />
      <h4 class="sidebar-title">Hi! I&#39;m Thibault ROHMER</h4>
    </a>
    <span class="sidebar-tagline"> \o/<br/>|<br/>/&nbsp;\ </span>
  </div>
  <nav class="sidebar-nav">
    <ul class="sidebar-nav-list">
      <li class="sidebar-nav-item nav-home">
        <span class="genericon genericon-home"></span><a class="sidebar-link" href="https://titi.github.io">Home</a>
      </li>
      <li class="sidebar-nav-item">
        <a class="genericon genericon-feed" href="posts/index.xml"></a><a class="sidebar-link" href="posts/">Posts/</a>
      </li>
      <li class="sidebar-nav-item">
        <a class="genericon genericon-feed" href="links/index.xml"></a><a class="sidebar-link" href="links/">Links/</a>
      </li>
    </ul>
  </nav>
  <div class="sidebar-externals">
  

  
  <a class="genericon genericon-github" href="https://github.com/TiTi" ></a>
  

  

  

  
  | <a class="genericon genericon-googleplus" href="https://plus.google.com/+ThibaultROHMER"></a>
  

  
  | <a class="genericon genericon-linkedin-alt" href="https://www.linkedin.com/in/thibaultrohmer"></a>
  

  
  | <a class="genericon genericon-mail" href="mailto:thibault.rohmer@gmail.com"></a>
  </div>
  <div class="sidebar-bottom">
    <hr />
    <p>Powered by <a href="http://gohugo.io">Hugo</a>.</p> <p>Theme: <a href="https://github.com/TiTi/hurock">Hurock</a>.</p>
    <p>Copyright &copy; 2017.</p> <p>All rights reserved.</p>
  </div>
</div>
</div>

</div>

<script src="highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-60799648-1', 'auto');
ga('send', 'pageview');
</script>




</body>
</html>

